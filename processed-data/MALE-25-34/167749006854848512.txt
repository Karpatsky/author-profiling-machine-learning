One of these days I'll actually hire somebody to design a proper design for HIF. In the meantime, more sloppy, cobbled together code!