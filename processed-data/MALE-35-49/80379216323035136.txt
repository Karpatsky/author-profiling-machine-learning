@NeilRobbins that should have read "the rest is fairly straightforward ". I might stick some comments in later if I get bored :)